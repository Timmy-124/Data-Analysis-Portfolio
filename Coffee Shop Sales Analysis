--- This analysis aims to answer key business questions, providing valuable insights into the performance of the coffee shop.

--- This dataset is gotten from Maven Analytics


--- What is the Total Revenue Generated?
SELECT SUM(transaction_qty * unit_price) AS total_revenue
FROM coffee_sales;


--- What is the Total Quantity Sold?
SELECT SUM(transaction_qty) AS total_quantity_sold
FROM coffee_sales;


--- What is the Average Price?
SELECT AVG(unit_price) AS average_price
FROM coffee_sales;


--- What are the Top 5 Best Selling Product Per Revenue?
SELECT product_type,
       SUM(transaction_qty * unit_price) AS total_revenue
FROM coffee_sales
GROUP BY product_type
ORDER BY total_revenue DESC
OFFSET 0 ROWS
FETCH NEXT 5 ROWS ONLY;


---What are the Most Purchased Products By Customers?
SELECT product_type,
       SUM(transaction_qty) AS no_of_quantity_sold
FROM coffee_sales
GROUP BY product_type
ORDER BY no_of_quantity_sold DESC
OFFSET 0 ROWS
FETCH NEXT 5 ROWS ONLY;


--- What are the Least Purchased Products By Customers?
SELECT product_type,
       SUM(transaction_qty) AS no_of_quantity_sold
FROM coffee_sales
GROUP BY product_type
ORDER BY no_of_quantity_sold ASC
OFFSET 0 ROWS
FETCH NEXT 5 ROWS ONLY;


--- What are the Top 5 Best Selling Category Per Revenue?
SELECT product_category,
       SUM(transaction_qty * unit_price) AS total_revenue
FROM coffee_sales
GROUP BY product_category
ORDER BY total_revenue DESC 
OFFSET 0 ROWS
FETCH NEXT 5 ROWS ONLY;


--- What are the Amount of Total Orders Made?
SELECT COUNT(*) AS total_orders_made
FROM coffee_sales;


--- What is the Average Order Value?
SELECT SUM(transaction_qty * unit_price)/ COUNT(transaction_id) AS avg_order_value
FROM coffee_sales;


--- What is the Total Revenue Generated Per Store Location?
SELECT store_location,
       SUM(transaction_qty * unit_price) AS total_revenue_generated
FROM coffee_sales
GROUP BY store_location
ORDER BY total_revenue_generated DESC


--- What is the Sales Trend By Month?
SELECT 
    MONTH(transaction_date) AS transaction_month,
    SUM(transaction_qty * unit_price) AS total_sales
FROM 
    coffee_sales
GROUP BY 
    MONTH(transaction_date)
ORDER BY 
    total_sales ASC;


--- What is the Weekly Trend By Total Quantity Sold?
SELECT 
    DATENAME(WEEKDAY, transaction_date) AS day_of_week,
    SUM(transaction_qty) AS total_quantity
FROM 
    coffee_sales
GROUP BY 
    DATENAME(WEEKDAY, transaction_date)
ORDER BY 
    total_quantity DESC


--- What is the Busiest Hour Of The Day?
SELECT 
    DATEPART(HOUR, transaction_time) AS hour_of_day,
    COUNT(transaction_id) AS transaction_count
FROM 
    coffee_sales
GROUP BY 
    DATEPART(HOUR, transaction_time)
ORDER BY 
    transaction_count DESC;
